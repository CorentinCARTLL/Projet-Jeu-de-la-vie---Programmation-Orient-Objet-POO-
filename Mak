l#  Makefile pour le projet Jeu de la Vie
#  Supporte l’arborescence avec sous-dossiers Components/ et Services/
CXX      = g++
CXXFLAGS = -std=c++20 -Wall -Wextra -Wpedantic -O2

# Répertoires
SRCDIR   = .
BUILDDIR = build
BINDIR   = __Exe__

# Trouve automatiquement tous les fichiers .cpp du projet
SOURCES  = $(shell find $(SRCDIR) -type f -name "*.cpp")

# Transforme chaque .cpp en .o (dans build/)
OBJECTS  = $(patsubst %.cpp,$(BUILDDIR)/%.o,$(SOURCES))

# Nom de l’exécutable final
TARGET   = $(BINDIR)/jeu_de_la_vie

# Règle principale
all: $(TARGET)

# Construction de l’exécutable
$(TARGET): $(OBJECTS)
	@mkdir -p $(BINDIR)
	$(CXX) $(CXXFLAGS) $^ -o $@
	@echo "✔ Build terminé : $(TARGET)"

# Compilation des .cpp → .o dans build/
$(BUILDDIR)/%.o: %.cpp
	@mkdir -p $(dir $@)
	$(CXX) $(CXXFLAGS) -c $< -o $@

# Nettoyage
clean:
	rm -rf $(BUILDDIR) $(BINDIR)
	@echo "✔ Nettoyage terminé."

# Exécution
run: all
	./$(TARGET)

